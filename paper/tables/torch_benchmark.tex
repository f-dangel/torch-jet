\begin{table}[!b]
  \centering
  \caption{\textbf{Benchmark from \cref{fig:benchmark} in numbers.}
    We fit linear functions and report their slopes, \ie, how much runtime and memory increase when incrementing the batch size or random samples.
    We show two significant digits and bold values are best according to parenthesized values.}
  \label{tab:benchmark}
  \vspace{1.5ex}
  % paths where the performances are stored
  \def\datapathLaplacianExact{../jet/exp/exp01_benchmark_laplacian/performance/architecture_tanh_mlp_768_768_512_512_1_device_cuda_dim_50_name_laplacian_vary_batch_size}
  \def\datapathLaplacianStochastic{../jet/exp/exp01_benchmark_laplacian/performance/architecture_tanh_mlp_768_768_512_512_1_batch_size_2048_device_cuda_dim_50_distribution_normal_name_laplacian_vary_num_samples}
  \def\datapathWeightedLaplacianExact{../jet/exp/exp01_benchmark_laplacian/performance/architecture_tanh_mlp_768_768_512_512_1_device_cuda_dim_50_name_weighted_laplacian_vary_batch_size}
  \def\datapathWeightedLaplacianStochastic{../jet/exp/exp01_benchmark_laplacian/performance/architecture_tanh_mlp_768_768_512_512_1_batch_size_2048_device_cuda_dim_50_distribution_normal_name_weighted_laplacian_vary_num_samples}
  \def\datapathBilaplacianExact{../jet/exp/exp01_benchmark_laplacian/performance/architecture_tanh_mlp_768_768_512_512_1_device_cuda_dim_5_name_bilaplacian_vary_batch_size}
  \def\datapathBilaplacianStochastic{../jet/exp/exp01_benchmark_laplacian/performance/architecture_tanh_mlp_768_768_512_512_1_batch_size_256_device_cuda_dim_5_distribution_normal_name_bilaplacian_vary_num_samples}
  % configuration options for the \num command
  \sisetup{%
    % scientific-notation=true,%
    round-mode=figures,%
    round-precision=2,%
    detect-weight, % for bolding to work
    tight-spacing=true, % less space around \cdot
  }
  \begin{small}
    \begin{tabular}{ccc|cccc}
      \toprule
      \textbf{Mode}
      & \makecell{\textbf{Per-datum or } \\ \textbf{-sample cost}}
      & \textbf{Implementation}
      & \textbf{Laplacian}
      & \makecell{\textbf{Weighted} \\ \textbf{Laplacian}}
      & \textbf{Biharmonic}
      \\
      \midrule
      \multirow{9}{*}{\textbf{Exact}}
      & \multirow{3}{*}{Time [ms]}
      & \textcolor{tab-blue}{Nested 1\textsuperscript{st}-order}
      & \input{\datapathLaplacianExact/hessian_trace_best.txt}
      & \input{\datapathWeightedLaplacianExact/hessian_trace_best.txt}
      & \input{\datapathBilaplacianExact/hessian_trace_best.txt}
      \\
      &
      & \textcolor{tab-orange}{Standard Taylor}
      & \input{\datapathLaplacianExact/jet_naive_best.txt}
      & \input{\datapathWeightedLaplacianExact/jet_naive_best.txt}
      & \input{\datapathBilaplacianExact/jet_naive_best.txt}
      \\
      &
      & \textcolor{tab-green}{Collapsed (ours)}
      & \textbf{\input{\datapathLaplacianExact/jet_simplified_best.txt}}
      & \textbf{\input{\datapathWeightedLaplacianExact/jet_simplified_best.txt}}
      & \textbf{\input{\datapathBilaplacianExact/jet_simplified_best.txt}}
      \\ \cmidrule{2-6}
      & \multirow{3}{*}{\makecell{Mem.\,[MiB] \\ (differentiable)}}
      & \textcolor{tab-blue}{Nested 1\textsuperscript{st}-order}
      & \input{\datapathLaplacianExact/hessian_trace_peakmem.txt}
      & \input{\datapathWeightedLaplacianExact/hessian_trace_peakmem.txt}
      & \textbf{\input{\datapathBilaplacianExact/hessian_trace_peakmem.txt}}\footnotemark
      \\
      &
      & \textcolor{tab-orange}{Standard Taylor}
      & \input{\datapathLaplacianExact/jet_naive_peakmem.txt}
      & \input{\datapathWeightedLaplacianExact/jet_naive_peakmem.txt}
      & \input{\datapathBilaplacianExact/jet_naive_peakmem.txt}
      \\
      &
      & \textcolor{tab-green}{Collapsed (ours)}
      & \textbf{\input{\datapathLaplacianExact/jet_simplified_peakmem.txt}}
      & \textbf{\input{\datapathWeightedLaplacianExact/jet_simplified_peakmem.txt}}
      & \input{\datapathBilaplacianExact/jet_simplified_peakmem.txt}
      \\ \cmidrule{2-6}
      & \multirow{3}{*}{\makecell{Mem.\,[MiB] \\ (non-diff.)}}
      & \textcolor{tab-blue}{Nested 1\textsuperscript{st}-order}
      & \input{\datapathLaplacianExact/hessian_trace_peakmem_nondifferentiable.txt}
      & \input{\datapathWeightedLaplacianExact/hessian_trace_peakmem_nondifferentiable.txt}
      & \input{\datapathBilaplacianExact/hessian_trace_peakmem_nondifferentiable.txt}
      \\
      &
      & \textcolor{tab-orange}{Standard Taylor}
      & \textbf{\input{\datapathLaplacianExact/jet_naive_peakmem_nondifferentiable.txt}}
      & \textbf{\input{\datapathWeightedLaplacianExact/jet_naive_peakmem_nondifferentiable.txt}}
      & \input{\datapathBilaplacianExact/jet_naive_peakmem_nondifferentiable.txt}
      \\
      &
      & \textcolor{tab-green}{Collapsed (ours)}
      & \textbf{\input{\datapathLaplacianExact/jet_simplified_peakmem_nondifferentiable.txt}}
      & \textbf{\input{\datapathWeightedLaplacianExact/jet_simplified_peakmem_nondifferentiable.txt}}
      & \textbf{\input{\datapathBilaplacianExact/jet_simplified_peakmem_nondifferentiable.txt}}
      \\
      \midrule
      \multirow{9}{*}{\textbf{Stochastic}}
      & \multirow{3}{*}{Time [ms]}
      & \textcolor{tab-blue}{Nested 1\textsuperscript{st}-order}
      & \input{\datapathLaplacianStochastic/hessian_trace_best.txt}
      & \input{\datapathWeightedLaplacianStochastic/hessian_trace_best.txt}
      & \input{\datapathBilaplacianStochastic/hessian_trace_best.txt}
      \\
      &
      & \textcolor{tab-orange}{Standard Taylor}
      & \input{\datapathLaplacianStochastic/jet_naive_best.txt}
      & \input{\datapathWeightedLaplacianStochastic/jet_naive_best.txt}
      & \input{\datapathBilaplacianStochastic/jet_naive_best.txt}
      \\
      &
      & \textcolor{tab-green}{Collapsed (ours)}
      & \textbf{\input{\datapathLaplacianStochastic/jet_simplified_best.txt}}
      & \textbf{\input{\datapathWeightedLaplacianStochastic/jet_simplified_best.txt}}
      & \textbf{\input{\datapathBilaplacianStochastic/jet_simplified_best.txt}}
      \\ \cmidrule{2-6}
      & \multirow{3}{*}{\makecell{Mem.\,[MiB]\\(differentiable)}}
      & \textcolor{tab-blue}{Nested 1\textsuperscript{st}-order}
      & \input{\datapathLaplacianStochastic/hessian_trace_peakmem.txt}
      & \input{\datapathWeightedLaplacianStochastic/hessian_trace_peakmem.txt}
      & \input{\datapathBilaplacianStochastic/hessian_trace_peakmem.txt}
      \\
      &
      & \textcolor{tab-orange}{Standard Taylor}
      & \input{\datapathLaplacianStochastic/jet_naive_peakmem.txt}
      & \input{\datapathWeightedLaplacianStochastic/jet_naive_peakmem.txt}
      & \input{\datapathBilaplacianStochastic/jet_naive_peakmem.txt}
      \\
      &
      & \textcolor{tab-green}{Collapsed (ours)}
      & \textbf{\input{\datapathLaplacianStochastic/jet_simplified_peakmem.txt}}
      & \textbf{\input{\datapathWeightedLaplacianStochastic/jet_simplified_peakmem.txt}}
      & \textbf{\input{\datapathBilaplacianStochastic/jet_simplified_peakmem.txt}}
      \\ \cmidrule{2-6}
      & \multirow{3}{*}{\makecell{Mem.\,[MiB]\\(non-diff.)}}
      & \textcolor{tab-blue}{Nested 1\textsuperscript{st}-order}
      & \input{\datapathLaplacianStochastic/hessian_trace_peakmem_nondifferentiable.txt}
      & \input{\datapathWeightedLaplacianStochastic/hessian_trace_peakmem_nondifferentiable.txt}
      & \input{\datapathBilaplacianStochastic/hessian_trace_peakmem_nondifferentiable.txt}
      \\
      &
      & \textcolor{tab-orange}{Standard Taylor}
      & \textbf{\input{\datapathLaplacianStochastic/jet_naive_peakmem_nondifferentiable.txt}}
      & \textbf{\input{\datapathWeightedLaplacianStochastic/jet_naive_peakmem_nondifferentiable.txt}}
      & \input{\datapathBilaplacianStochastic/jet_naive_peakmem_nondifferentiable.txt}
      \\
      &
      & \textcolor{tab-green}{Collapsed (ours)}
      & \textbf{\input{\datapathLaplacianStochastic/jet_simplified_peakmem_nondifferentiable.txt}}
      & \textbf{\input{\datapathWeightedLaplacianStochastic/jet_simplified_peakmem_nondifferentiable.txt}}
      & \textbf{\input{\datapathBilaplacianStochastic/jet_simplified_peakmem_nondifferentiable.txt}}
      \\
      \bottomrule
    \end{tabular}
  \end{small}
\end{table}
\footnotetext{For the exact biharmonic, the 1\textsuperscript{st}-order AD implementation---unlike our Taylor mode implementations---has a somewhat unfair advantage: it leverages the operatorâ€™s special structure by computing it as the Laplacian of the Laplacian, $\Delta^2 \vf(\vx_0) = \Delta ( \Delta \vf(\vx_0) )$.
Had we instead naively computed, then summed, the fourth-order derivatives by tensor-vector-products (TVPs) with $\partial^4 \vf(\vx_0)$ \cite[\eg done in][]{hu2023hutchinson}, performance would have degraded \emph{dramatically}, similar to the performance gap we observe for the stochastic biharmonic operator which has to use these TVPs.
Hence, we omit this naive exact approach, which, however, is \emph{necessary for general operators}.

We chose the biharmonic as a case study for a general linear differential operator to show that even here, collapsing Taylor yields improvements, despite increased memory use.
In \cref{sec:jax-benchmark}, we confirm that incorporating this advantage by nesting Laplacians---also possible in (collapsed) Taylor mode---offers the most efficient approach, achieving roughly 3x better runtime and memory with our collapsing technique (\cref{tab:jax-benchmark,fig:jax-benchmark}).}
%%% Local Variables:
%%% mode: LaTeX
%%% TeX-master: "../main"
%%% End:
